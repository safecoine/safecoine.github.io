for(let i=0; i<coins.length; i++) {
  let c = coins[i];
  c.y += c.speed;

  if(
    c.y + coinRadius >= basket.y &&
    c.x >= basket.x &&
    c.x <= basket.x + basket.width
  ){
    if(c.type === 'trap') {
      gameOver = true;
      showMessage(randomLoseMessage());
      showRestartButton();
    } else {
      score++;
      document.getElementById('score').textContent = 'امتیاز: ' + score;
      showCheerMessage();
      if(score % 5 === 0 && maxCoins < 10) {
        maxCoins++;
        coins.push(createCoin());
      }
    }
    coins[i] = createCoin();
  }

  if(c.y - coinRadius > canvas.height && c.type === 'normal') {
    // کوین رد شده بدون اینکه گرفته بشه: بازی باخته
    gameOver = true;
    showMessage(`کوین رد شد، باختی! امتیاز نهایی: ${score}`);
    showRestartButton();
  }

  drawCoin(c);
}
