<canvas id="gameCanvas"></canvas>
<button id="restartBtn" style="display:none;">دوباره بازی کن</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score = 0;
let isGameOver = false;
let basket = { x: canvas.width / 2 - 50, y: canvas.height - 100, width: 100, height: 30 };
let coins = [];

function startGame() {
    score = 0;
    isGameOver = false;
    coins = [];
    document.getElementById("restartBtn").style.display = "none";
    spawnCoin();
    gameLoop();
}

function spawnCoin() {
    coins.push({ x: Math.random() * (canvas.width - 30), y: 0, size: 30, speed: 3 });
}

function gameLoop() {
    if (isGameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // سبد
    ctx.fillStyle = "brown";
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);

    // کوین‌ها
    ctx.fillStyle = "gold";
    for (let coin of coins) {
        ctx.beginPath();
        ctx.arc(coin.x, coin.y, coin.size / 2, 0, Math.PI * 2);
        ctx.fill();

        coin.y += coin.speed;

        // گرفتن کوین
        if (
            coin.y + coin.size / 2 >= basket.y &&
            coin.x >= basket.x &&
            coin.x <= basket.x + basket.width
        ) {
            score++;
            coin.y = -100;
            coin.x = Math.random() * (canvas.width - 30);
        }

        // رد شدن کوین
        if (coin.y > canvas.height) {
            gameOver();
        }
    }

    // امتیاز
    ctx.fillStyle = "black";
    ctx.font = "24px Arial";
    ctx.fillText("امتیاز: " + score, 20, 30);

    requestAnimationFrame(gameLoop);
}

function gameOver() {
    isGameOver = true;
    document.getElementById("restartBtn").style.display = "block";
}

document.addEventListener("touchmove", (e) => {
    let touchX = e.touches[0].clientX;
    basket.x = touchX - basket.width / 2;
});

document.getElementById("restartBtn").addEventListener("click", startGame);

startGame();
</script>
