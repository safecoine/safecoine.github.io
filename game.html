<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SafeCoin - Ø¨Ø§Ø²ÛŒ Coin Catcher</title>
<style>
  body {
    margin: 0; padding: 0; background: #0d1117; color: #fff;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }
  #gameArea {
    position: relative;
    width: 100vw; height: 100vh;
    background: linear-gradient(to bottom, #161b22 0%, #238636 100%);
    overflow: hidden;
  }
  #basket {
    position: absolute;
    bottom: 10px;
    left: 50%;
    width: 80px;
    height: 30px;
    background: #238636;
    border-radius: 15px;
    transform: translateX(-50%);
    box-shadow: 0 0 10px #238636;
  }
  .coin, .trap {
    position: absolute;
    top: -50px;
    width: 40px; height: 40px;
    border-radius: 50%;
    box-shadow: 0 0 10px #ffd700;
  }
  .coin {
    background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Binance-Coin-BNB-icon-logo.svg/1200px-Binance-Coin-BNB-icon-logo.svg.png') no-repeat center;
    background-size: contain;
    box-shadow: 0 0 15px #f0d94e;
  }
  .trap {
    background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Red_x.svg/768px-Red_x.svg.png') no-repeat center;
    background-size: contain;
    box-shadow: 0 0 15px #ff4c4c;
  }
  #score {
    position: absolute;
    top: 10px; left: 10px;
    font-size: 24px;
    font-weight: bold;
  }
  #message {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 28px;
    background: rgba(0,0,0,0.7);
    padding: 20px;
    border-radius: 15px;
    display: none;
    text-align: center;
  }
  #restartBtn {
    margin-top: 15px;
    padding: 10px 20px;
    background: #238636;
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 20px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="gameArea">
  <div id="score">Ø§Ù…ØªÛŒØ§Ø²: 0</div>
  <div id="basket"></div>
  <div id="message">
    Ø¨Ø§Ø®ØªÛŒ! ğŸ˜‚<br />
    Ø¨Ø§Ø²ÛŒ Ø±Ùˆ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†!<br />
    <button id="restartBtn">Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡</button>
  </div>
</div>

<script>
  const gameArea = document.getElementById('gameArea');
  const basket = document.getElementById('basket');
  const scoreEl = document.getElementById('score');
  const message = document.getElementById('message');
  const restartBtn = document.getElementById('restartBtn');

  let basketX = window.innerWidth / 2;
  let basketWidth = basket.offsetWidth;
  let score = 0;
  let coins = [];
  let traps = [];
  let gameInterval;
  let spawnInterval;
  let speed = 2;
  let gameOver = false;

  // Ø­Ø±Ú©Øª Ø³Ø¨Ø¯ Ø¨Ø§ Ù„Ù…Ø³ ÛŒØ§ Ù…ÙˆØ³
  function moveBasket(x) {
    basketX = x - basketWidth / 2;
    if (basketX < 0) basketX = 0;
    if (basketX > window.innerWidth - basketWidth) basketX = window.innerWidth - basketWidth;
    basket.style.left = basketX + 'px';
  }

  window.addEventListener('mousemove', e => {
    if (!gameOver) moveBasket(e.clientX);
  });
  window.addEventListener('touchmove', e => {
    if (!gameOver) moveBasket(e.touches[0].clientX);
  });

  // Ø§ÛŒØ¬Ø§Ø¯ Ø³Ú©Ù‡ ÛŒØ§ ØªÙ„Ù‡
  function spawnItem() {
    if (gameOver) return;
    const isTrap = Math.random() < 0.2; // Û²Û°Ùª Ø§Ø­ØªÙ…Ø§Ù„ ØªÙ„Ù‡
    const item = document.createElement('div');
    item.classList.add(isTrap ? 'trap' : 'coin');
    item.style.left = Math.random() * (window.innerWidth - 40) + 'px';
    gameArea.appendChild(item);
    if (isTrap) traps.push(item);
    else coins.push(item);
  }

  // Ø­Ø±Ú©Øª Ø§Ø´ÛŒØ§Ø¡ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ†
  function updateItems() {
    if (gameOver) return;
    // Ø­Ø±Ú©Øª Ø³Ú©Ù‡ Ù‡Ø§
    for (let i = coins.length - 1; i >= 0; i--) {
      let coin = coins[i];
      let top = coin.offsetTop + speed;
      coin.style.top = top + 'px';

      if (top > window.innerHeight) {
        coin.remove();
        coins.splice(i, 1);
        continue;
      }
      if (checkCatch(coin)) {
        score++;
        scoreEl.textContent = 'Ø§Ù…ØªÛŒØ§Ø²: ' + score;
        coin.remove();
        coins.splice(i, 1);
        speed += 0.1; // Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø±Ø¹Øª Ø¨Ø§ Ø§Ù…ØªÛŒØ§Ø²
      }
    }
    // Ø­Ø±Ú©Øª ØªÙ„Ù‡ Ù‡Ø§
    for (let i = traps.length - 1; i >= 0; i--) {
      let trap = traps[i];
      let top = trap.offsetTop + speed;
      trap.style.top = top + 'px';

      if (top > window.innerHeight) {
        trap.remove();
        traps.splice(i, 1);
        continue;
      }
      if (checkCatch(trap)) {
        gameOver = true;
        showGameOver();
      }
    }
  }

  // Ú†Ú© Ú©Ø±Ø¯Ù† Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ø³Ø¨Ø¯
  function checkCatch(item) {
    let itemRect = item.getBoundingClientRect();
    let basketRect = basket.getBoundingClientRect();

    return !(
      itemRect.right < basketRect.left ||
      itemRect.left > basketRect.right ||
      itemRect.bottom < basketRect.top ||
      itemRect.top > basketRect.bottom
    );
  }

  // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø¨Ø§Ø®Øª
  function showGameOver() {
    message.style.display = 'block';
  }

  // Ø´Ø±ÙˆØ¹ ÛŒØ§ Ø±ÛŒØ³Øª Ø¨Ø§Ø²ÛŒ
  function startGame() {
    message.style.display = 'none';
    score = 0;
    speed = 2;
    gameOver = false;

    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø³Ú©Ù‡ Ùˆ ØªÙ„Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
    coins.forEach(c => c.remove());
    traps.forEach(t => t.remove());
    coins = [];
    traps = [];

    // Ù…ÙˆÙ‚Ø¹ÛŒØª Ø³Ø¨Ø¯ ÙˆØ³Ø· ØµÙØ­Ù‡
    basketX = window.innerWidth / 2 - basketWidth / 2;
    basket.style.left = basketX + 'px';

    if (gameInterval) clearInterval(gameInterval);
    if (spawnInterval) clearInterval(spawnInterval);

    gameInterval = setInterval(updateItems, 20);
    spawnInterval = setInterval(spawnItem, 700);
  }

  restartBtn.addEventListener('click', startGame);

  // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ ÙˆÙ‚ØªÛŒ ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ø´Ø¯
  window.onload = startGame;
</script>

</body>
</html>
